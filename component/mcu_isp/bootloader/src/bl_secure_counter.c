/*
 * Copyright 2014-2016 Freescale Semiconductor, Inc.
 * Copyright 2016-2018 NXP
 * All rights reserved.
 *
 * SPDX-License-Identifier: BSD-3-Clause
 *
 */

#include "bootloader/bl_secure_counter.h"
#include "bootloader_common.h"
#include "bootloader/bootloader.h"

////////////////////////////////////////////////////////////////////////////////
// Definitions
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Prototypes
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
// Variables
////////////////////////////////////////////////////////////////////////////////

//__no_init volatile secure_counter_t g_secure_counter BL_SECTION(".secure_counter");
volatile secure_counter_t g_secure_counter BL_SECTION(".noinit");

////////////////////////////////////////////////////////////////////////////////
// Code
////////////////////////////////////////////////////////////////////////////////
void secure_counter_init(void)
{
    g_secure_counter = SC_SECURE_INIT_VAL;
}
__NO_RETURN void secure_counter_assert_fail(void)
{
    go_fatal_mode();

    while (1)
        ;
}
////////////////////////////////////////////////////////////////////////////////
// EOF
////////////////////////////////////////////////////////////////////////////////
